/**
* Vibe.
* (c) 2021 Bret Lowry
* @license MIT
* @description VibeJS a component library for composing apps
* @author Bret Lowry <bretgeek@gmail.com>
* @constructor
* @param {object} $self - optional, defaults to document.
* @return {object} obj with keys pointing to functions and types
*/
function Vibe(e=document,{fn:t={}}={}){let n=false;if(e.nodeName==="#document"){n=true}let r=false;if(n){(function e(){if(document.readyState!="loading"){r=true}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",(function(){r=true}))}else{document.attachEvent("onreadystatechange",(function(){if(document.readyState!="loading"){r=true}}))}})()}function i(e,t=3e3){let n;let i;let s=1;n=setInterval(()=>{if(r){clearInterval(n);clearTimeout(i);if(e&&Q(e)&&s<=1){try{e();s++}catch(e){console.error(e)}}else{return true}}},6);i=setTimeout(()=>{r=true},t)}function s(t,{html:r=true}={}){if(n){return this}o(e,t,{html:r});return this}function o(e,t,{html:n=true}={}){if(e.templateText){if(n){e.$html(e.templateHTML)}else{e.$text(e.templateText)}}const r=e.$text();const i=e.$html();e.templateText=r;e.templateHTML=i;const s=Object.keys(t);for(const r of s){let i=e.$text();if(n){i=e.$html()}i=i.replace(/\{\{\s*/g,"{{");i=i.replace(/\s*\}\}/g,"}}");if(t.hasOwnProperty(r)){const s=`{{${r}}}`;const o=new RegExp(s,"g");const f=i.replace(o,`${t[r]}`);if(n){e.$html(f)}else{e.$text(f)}}}return this}function f(e,{to:r="body",type:s="div",position:f="append",state:a={},props:c={},plugin:l={},events:p={},vdata:$={},className:m="vibe"}={}){let b=r;if(!ee(b)){b=document.querySelector(r)}if(Q(e)){const t=e();if(n){}const v=document.createElement(`${s}`);v.$=new Vibe(v);if(t.template&&t.template.length){v.innerHTML=t.template}if(h($)){$=d(v)}if(t.className&&t.className.length){v.classList.add(t.className)}v.classList.add(m);if(Z(l)){const e=Object.keys(l);for(const t of e){if(Q(l[t])){l[t].bind(this,v);v[`$${t}`]=l[t]}}}if(t.fn){if(Object.keys(t.fn).length>0){v.$fn=t.fn}}v.$props=c;v.$self=v;const y=Object.keys($);v.$vdata=$;o(v,$);for(const e of y){const t=e;v[t]=function(e=false){if(e){v.$vdata[t]=e;o(v,v.$vdata)}}}if(t.state){v.$state=t.state;v.$origState=t.state}else{v.$state=a;v.$origState=a}if(t.events){if(Object.keys(t.events).length>0){v.$event=t.events;for(const e in v.$event){v.addEventListener(e,v.$event[e],true)}}}if(Object.keys(p).length>0){v.$event=p;for(const e in v.$event){v.addEventListener(e,v.$event[e],true)}}v.id="v"+ne();if(ee(b)){i(u(v,b,f));v.$mountedTo=r}else{let e=0;const t=setInterval((function(){e++;if(ee(b)){i(u(v,b,f));v.$mountedTo=r;clearInterval(t)}if(e>60){clearInterval(t);throw new Error(`Whoops! could not mount to ${r} element.`)}}),100)}if(Q(t.init)){v.init=t.init;i(v.init(v))}return v}else{if(e.nodeType===1){if(!e.$){e.$=new Vibe(e)}if(Z(l)){const t=Object.keys(l);for(const n of t){if(Q(l[n])){l[n].bind(this,e);e[`$${n}`]=l[n]}}}const t=Object.keys($);e.$vdata=$;o(e,$);for(const n of t){const t=n;e[t]=function(n=false){if(n){e.$vdata[t]=n;o(e,e.$vdata)}}}e.classList.add(m);e.$props=c;e.$self=e;e.$state=a;e.$origState=a;if(Object.keys(p).length>0){e.$event=p;for(const t in e.$event){e.addEventListener(t,e.$event[t],true)}}if(!e.id){e.id="v"+ne()}return e}else if(G(e)){let n=null;if(w(e)){let t;t=w(e,true);n=document.createElement(`${t[0]}`);n.innerHTML=t[1]}else{n=document.createElement(`${s}`);n.innerHTML=e}n.$=new Vibe(n);if(Object.keys(t).length>0){n.$fn=t}n.$props=c;n.$self=n;n.$obj=n.$;n.classList.add(m);n.$state=a;n.$origState=a;if(Z(l)){const e=Object.keys(l);for(const t of e){if(Q(l[t])){l[t].bind(this,n);n[`$${t}`]=l[t]}}}const r=Object.keys($);n.$vdata=$;o(n,$);for(const e of r){const t=e;n[t]=function(e=false){if(e){n.$vdata[t]=e;o(n,n.$vdata)}}}if(Object.keys(p).length>0){n.$events=p;for(const e in n.$events){n.addEventListener(e,n.$events[e],true)}}n.id="v"+ne();i(u(n,b,f));return n}}}function u(e,t,n){switch(n){case"after":e.$insertAfter(t);break;case"before":e.$insertBefore(t);break;case"prepend":e.$prependTo(t);break;default:e.$appendTo(t);break}return this}function a(t="mousedown",n,r=false){let i=r;if(typeof r==="boolean"){if(r){i={capture:true}}else{i={capture:false}}}const s=t.split(",");for(let t of s){t=t.trim();e.addEventListener(t,n,i)}return this}function c(t="mousedown",n,r=false){const i=e;let s=r;if(typeof r==="boolean"){if(r){s={capture:true}}else{s={capture:false}}}const o=t.split(",");for(const e of o){i.removeEventListener(e,n,s)}return this}function l(t){const n=e;const r=new Event(t);n.dispatchEvent(r,{bubbles:true,cancelable:true});return this}function d(e){const t=e.$text();const n=/{{(.*?)}}/g;const r=t.matchAll(n);const i=Array.from(r);const s=[];for(const e of i){if(!/^\d/.test(e[1])&&e[1].length){s.push(e[1].trim())}}const o={};if(s.length){for(const e of s){o[e]=""}}return o}function p(t,{all:n=false,vibe:r=true,fn:i=false,plugin:s={},inject:f=false,vdata:u={}}={}){if(!n){let n=false;if(t.startsWith("#")){t=t.replace(/#/,"");n=document.getElementById(t)}else{n=e.querySelectorAll(t)[0]}if(n){if(r){if(G(f)&&Z(u)&&!h(u)){const e=n.innerHTML;n.innerHTML=`${e}${f}`}n.$=Vibe().render(n);if(h(u)){u=d(n)}if(Z(u)&&!h(u)){const e=Object.keys(u);n.$vdata=u;o(n,u);for(const t of e){const e=t;n[e]=function(t=false){if(t){n.$vdata[e]=t;o(n,n.$vdata)}}}}}if(Z(s)){const e=Object.keys(s);for(const t of e){if(Q(s[t])){s[t].bind(this,n);n[`$${t}`]=s[t]}}}if(Q(i)){i(n)}return n}else{return false}}else{const n=e.querySelectorAll(t);if(n.length){if(r){n.forEach(e=>{if(G(f)&&Z(u)&&!h(u)){const t=e.innerHTML;e.innerHTML=`${t}${f}`}e.$=Vibe().render(e);if(h(u)){u=d(e)}if(Z(u)&&!h(u)){const t=Object.keys(u);e.$vdata=u;o(e,u);for(const n of t){const t=n;e[t]=function(n=false){if(n){e.$vdata[t]=n;o(e,e.$vdata)}}}}})}if(Z(s)){const e=Object.keys(s);for(const t of e){if(Q(s[t])){s[t].bind(this,single);n.forEach(e=>{s.bind(this,e);e[s.name]=s})}}}if(Q(i)){n.forEach(e=>{i(e)})}return n}else{return false}}}function h(e){return Object.keys(e).length===0}function $(e){e=e.toString();e=e.replace(/px/g,"");e=e.replace(/%/g,"");e=e.replace(/em/g,"");e=Math.round(Number(e));return e}function m(e){const t=window.getComputedStyle(e,null);const n=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform")||"none";if(n!="none"){const e=n.split("(")[1].split(")")[0].split(",");const t=Math.round(Math.atan2(e[1],e[0])*(180/Math.PI));return t<0?t+360:t}return 0}function b(t,r=true){if(n){return this}if(t=="rotate"){return m(e)}if(t==="position"){return e.style.position}if(t==="offsetLeft"){return e.offsetLeft}if(t==="offsetTop"){return e.offsetTop}if(t==="offsetHeight"){return e.offsetHeight}if(t==="offsetWidth"){return e.offsetHeight}let i=getComputedStyle(e).getPropertyValue(t)||null;if(r){try{i=$(i)}catch(e){console.error(e)}}return i}function v(t="2d",r=false){if(n){return this}if(e.tagName==="CANVAS"||e.nodeName==="CANVAS"||e instanceof HTMLCanvasElement){if(r){return e.getContext(t,r)}else{return e.getContext(t)}}else{throw new Error("$self must be an instance of canvas.")}}function y(t=false,n=false){const r=["x","y","width","height","right","left","top","bottom"];if(!r.includes(t)){return null}const i=e.getBoundingClientRect()[t];if(n){return Math.round(i)}else{return i}}function g(e){const t=document.createElement(e[0]);t.innerHTML=e[1];return t}function w(e,t=false){const n=(new DOMParser).parseFromString(e,"text/html");if(t){return[n.body.childNodes[0].tagName.toLowerCase(),n.body.childNodes[0].innerHTML]}else{return Array.from(n.body.childNodes).some(e=>e.nodeType===1)}}function x(e=false,t,n){for(const r of e){if(!n){return r[`${t}`]}else{r[`${t}`]=n}}}function k(t=false){if(n){x(e.stk,"textContent",t);return this}if(!t){return e.textContent}else{e.textContent=t}return this}function M(t=false){if(n){x(e.stk,"innerHTML",t);return this}if(!t){return e.innerHTML}else{e.innerHTML=t}return this}function T(e){q(e);return this}function L(e){q(e,true);return this}function O(e){q(e,true,true);return this}function E(e){q(e,false,true);return this}function q(t,r=false,i=false){if(n){return this}const s=e;if(G(t)){let e;if(w(t)){e=g(w(t,true),true);if(!e){return this}}else{e=document.querySelectorAll(t)[0];if(!e){return this}}if(r){if(i){e.before(s)}else{s.before(e)}}else{if(i){e.after(s)}else{s.after(e)}}}if(ee(t)){if(r){if(i){t.before(s)}else{s.before(t)}}else{if(i){t.after(s)}else{s.after(t)}}}return this}function j(t,r=false){if(n){return this}const i=e;if(!t){return this}if(G(t)){let e;if(w(t)){e=g(w(t,true),true)}else{e=t}if(r){i.prepend(e)}else{i.append(e)}}else{if(r){i.prepend(t)}else{i.append(t)}}return this}function I(e){if(n){return this}if(!e){return this}j(e,true);return this}function A(e){if(!e){return this}V(e,true);return this}function S(e){if(!e){return this}V(e);return this}function V(t,r=false){if(n){e=e.body}const i=e;if(G(t)){const e=document.querySelectorAll(t)[0];if(!e){return this}if(r){e.prepend(i)}else{e.append(i)}}if(ee(t)){if(r){t.prepend(i)}else{t.append(i)}return this}}function F(t=false,r=false){if(n){return this}let i;let s;if(r){s=`-${e.$cs("left",true)+t}`}else{i=`${e.$cs("left",true)+t}`}if(i){return i}else{return s}if(!i||!s){return e.$cs("left",true)}}function N(t,{add:r=true}={}){function i(e){for(const n of e){if(!r){n.style.cssText=t}else{n.style.cssText=n.style.cssText+t}}}if(n){i(e.stk);return this}if(!t){return this}if(e.$stk.length){i(e.$stk)}else{if(!r){e.style.cssText=t}else{e.style.cssText=e.style.cssText+t}}return this}function C(t="div",{override:r=false,position:i=false,inject:s=false,vdata:o=false,to:f=false}={}){const u=["html","head","link","meta","script","style","title","body","article","aside","footer","header","h1","h2","h3","h4","h5","h6","main","nav","section","blockquote","div","figure","hr","li","ol","p","pre","ul","a","code","data","time","em","i","span","strong","audio","source","img","track","video","iframe","svg","canvas","noscript","col","colgroup","button","option","fieldset","label","form","input","select","textarea","menu","template"];if(!u.includes(t)){if(!r){t="div"}}const a=document.createElement(t);const c=a;c.$=Vibe().render(a,{vdata:o});if(s){c.$html(s)}if(!f){f=e}if(n&&!f){return c}if(!ee(f)){f=document.querySelector("body")}if(n){if(!f){f=document.body}if(i){if(i!=="prepend"){if(i!=="append"){i="append"}}}}if(i&&f){switch(i){case"after":c.$insertAfter(f);break;case"before":c.$insertBefore(f);break;case"prepend":c.$prependTo(f);break;default:c.$appendTo(f);break}return c}else{return c}}function H(t=false){if(n){return this}let r=false;let i="";if(t){i=e.id;r=e.cloneNode(true)}e.remove();if(t){r.$=new Vibe(r);r.id=i;return r}else{return this}}function P({to:t=false,position:r="append"}={}){if(n){return this}const s=e.cloneNode(true);s.$=new Vibe(s);s.id="v"+ne();if(t){if(!ee(t)){t=document.querySelector(t)}i(u(s,t,r))}return s}function D(t,r=false){if(n){return this}const i=e;if(!r){i.classList.add(t)}else{i.classList.remove(t)}return this}function B(e){if(n){return this}D(e,true);return this}function X(e){if(n){return this}R(e,false,true);return this}function Y(t=false){if(n){return this}if(t){const n=t.split(",");for(let t of n){t=t.trim();t=t.replace(/\./g,"");if(e.classList.contains(t)){e.$removeClass(t)}else{e.$addClass(t)}}}return this}function R(t,r=false,i=false){if(n){return this}const s=e;if(t&&G(t)){if(i){s.removeAttribute(t);return this}if(G(r)||typeof r==="number"){s.setAttribute(t,r);return this}if(!r){const e=s.getAttribute(t);return e}}}function z(){if(n){return this}return e.dataset}function W(t,r="get"){const i=e;if(n){return this}if(r==="remove"){i.removeAttribute("data-"+t)}if(r==="set"){i.setAttribute("data-"+t,t)}if(r==="get"){return i.getAttribute("data-"+t)}}function U(t=false,{fn:r=false,vibe:i=true}={}){let s=[];let o;let f=e;if(n){return this}if(G(t)){o=t.split(",");while(f=f.parentElement){o.forEach(e=>{e=e.trim();if(f.matches(e)&&!s.includes(f)){s.push(f);console.log(f.classList)}})}}if(!t){while(f=f.parentElement){s.push(f)}}if(s.length){s=s.filter((e,t,n)=>n.indexOf(e)==t);if(i){for(const e of s){e.$=new Vibe(e)}}if(Q(r)){for(const e of s){r(e)}}}return s}function _(t=false,{fn:n=false,vibe:r=true}={}){const i=[];let s;const o=e;const f=e.getElementsByTagName("*");if(G(t)){s=t.split(",");for(const e of f){s.forEach(t=>{t=t.trim();if(e.matches(t)){i.push(e)}})}}if(!t){for(const e of f){i.push(e)}}if(i.length){if(r){for(const e of i){e.$=new Vibe(e)}}if(Q(n)){for(const e of i){n(e)}}}console.log(i);return i}function G(e){return typeof e==="string"}function J(e){return/^-{0,1}\d+$/.test(e)}function K(e){const t=/^-?[0-9]+$/;return t.test(e)}function Q(e){return typeof e==="function"}function Z(e){if(Object.prototype.toString.call(e).slice(8,-1)==="Object"){return true}else{return false}}function ee(e){return e.nodeType==1}function te(e){if(Array.isArray(e)){return true}else{return false}}function ne(){if(Z(crypto)){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}else{let e=(new Date).getTime();let t=performance&&performance.now&&performance.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{let r=Math.random()*16;if(e>0){r=(e+r)%16|0;e=Math.floor(e/16)}else{r=(t+r)%16|0;t=Math.floor(t/16)}return(n=="x"?r:r&7|8).toString(16)})}}function re(e,t=false){e=e.replace(/[^\x20-\x7E]+/g,"");if(t){e=e.replace(/[^a-z0-9-#]+|\s+/gim,"")}e=e.trim();return e}function ie(){if(n){return this}return e.id}function se(t){if(Q(t)){t(e)}return this}function oe(t={}){if(n){return this}e.$state=t}function fe(t){if(n){return this}return e.$state[t]}function ue(t,n="name",{delay:r=10,child:i=true,attr:s=true,subtree:o=false,attrs:f=["none"],chardat:u=false,attrsOV:a=false,chardatOV:c=false}){if(typeof t!=="function"){return}const l={childList:i,attributes:s,characterData:u,subtree:o,attributeFilter:f,attributeOldValue:a,characterDataOldValue:c};const d=e;const p=new MutationObserver((function(e){e.forEach((function(e){if(e.type==="attributes"){if(f[0]!=="none"){setTimeout(()=>{t(d)},r)}}else{if(f[0]==="none"){if(e.type==="childList"||e.type==="subtree"||e.type==="characterData"){setTimeout(()=>{t(d)},r)}}}}))}));if(e.$observers[n]){e.$observers[n].disconnect();delete e.$observers[n]}e.$observers[n]=p;e.$observers[n].observe(e,l);const h=Object.keys(e.$observers);return this}function ae(t="name"){if(t==="all"){const t=Object.keys(e.$observers);for(const n of t){delete e.$observers[n];n.disconnect()}}else{if(e.$observers[t]){e.$observers[t].disconnect();delete e.$observers[t]}}return this}function ce(){const t=Object.keys(e.$observers);return t}async function le({url:e=false,type:t="json",fn:n=false,e:r={}}={}){const i=await fetch(e);let s;if(t=="json"){s=await i.json()}if(t=="text"){s=await i.text()}if(Q(n)){n(s,r)}}function de({url:t=false,type:n="text",body:r=false,contentType:i="application/x-www-form-urlencoded",fn:s=false}={}){e.isPost=false;if(!t||!r){return false}fetch(t,{headers:new Headers({"Content-Type":`${i}`}),method:"post",body:r}).then((function(e){if(e.ok){if(n==="json"){return e.json()}else{return e.text()}}return Promise.reject(e)})).then((function(t){e.isPost=true;if(Q(s)){s(t)}})).catch((function(e){console.warn("Something went wrong.",e)}))}function pe(){return window.matchMedia("(pointer: coarse)").matches||false}function he(){setTimeout((function(){e.onfocus=blur()}),100);return this}window.requestInterval=function(e,t){const n=Date.now;const r=window.requestAnimationFrame;let i=n();let s;var o=function(){n()-i<t||(i+=t,e());s||r(o)};r(o);return{clear:function(){s=1},start:function(){n()}}};function $e({display:t="block",speed:n=300}={}){const r=e.$cs("display");e.$css(`display: ${r}; visibility: visible; opacity: 0.0;`,{add:true});e.$css(`display: ${t}; visibility: visible;`,{add:true});let i=0;const s=requestInterval((function(){i++;if(i<=9){e.$css(`opacity: 0.${i} `,{add:true})}else{i=1;e.$css(`opacity: ${i} `,{add:true});s.clear()}}),n);return this}function me({display:t="block",speed:n=300}={}){const r=e.$cs("display");e.$css(`display: ${r}; visibility: visible; opacity: 1;`,{add:true});e.$css(`display: ${t}; visibility: visible;`,{add:true});let i=1;const s=requestInterval((function(){if(i>.1){i-=.1;i=i.toFixed(2);e.$css(`opacity: ${i} `,{add:true})}else{i=0;e.$css(`opacity: ${i} `,{add:true});e.$isrun=false;e.$runq();s.clear()}}),n);return this}function be(){e.$fadeIn({speed:1});return this}function ve(){e.$fadeOut({speed:1});return this}function ye({time:t=1e3,fn:n=false}){function r(){const r=new Date;const i=r.getTime()+t;const s=requestInterval((function(){const t=new Date;if(t.getTime()>=i){if(Q(n)){n(e)}e.$isrun=false;e.$runq();s.clear()}}),1)}e.$q.push(r);if(e.$q.length){e.$runq()}return this}function ge(t,n=1){if(Q(t)){e.$delay({time:n,fn:t})}return this}function we(){let t;if(!e.$isrun){e.$isrun=true;t=e.$q.shift();if(Q(t)){t(e);we()}}return null}function xe(e,t){return document.elementFromPoint(e,t)}function ke(e=0){let t=window.location.pathname;const n=t;t=t.split("/");const r=t[e];if(r.length&&e>0){return r}else{return n}}function Me({el:t=false,el2:r=false}){if(n&&!r){return this}if(!r){r=e}const i=t.getBoundingClientRect();const s=r.getBoundingClientRect();return!(i.top+i.height<s.top||i.top>s.top+s.height||i.left+i.width<s.left||i.left>s.left+s.width)}function Te({draghandle:t=false,contain:n="body",dropfn:r=false,drop:i=false,over:s=false,overfn:o=false,zIndex:f=1}={}){const u=e;let a=false;let c;let l;let d;let p;let h=0;let $=0;const m=document.querySelectorAll(n)[0];const b=u.parentNode||u.parentElement;const v=u;let y;if(i&&G(i)){y=document.querySelector(i)}let g;if(s&&G(s)){g=document.querySelector(s)}b.addEventListener("touchstart",x,false);b.addEventListener("touchend",k,false);b.addEventListener("touchmove",M,false);b.addEventListener("mousedown",x,false);b.addEventListener("mouseup",k,false);m.addEventListener("mouseleave",k,false);b.addEventListener("mousemove",M,false);let w=false;function x(e){const n=u.$cs("position");if(n!=="absolute"){u.$css("position: absolute;")}if(e.type==="touchstart"){d=e.touches[0].clientX-h;p=e.touches[0].clientY-$}else{if(!w){w=true;d=e.clientX-h;p=e.clientY-$}else{d=e.clientX-h;p=e.clientY-$}}if(e.target.matches(t)||!t){e.target.style.cssText="user-select: none; cursor: pointer;";a=true}T(c,l,v)}function k(t){d=c;p=l;if(y&&u.$isTouching({el:y})&&a){r({dragee:e,dropee:y});a=false}a=false;T(c,l,v)}function M(t){if(a){t.preventDefault();if(t.type==="touchmove"){c=t.touches[0].clientX-d;l=t.touches[0].clientY-p}else{c=t.clientX-d;l=t.clientY-p}if(g&&u.$isTouching({el:g})&&Q(o)&&a){o({dragee:e,dropee:g})}h=c;$=l;T(c,l,v)}}function T(e,t,n){n.style.transform="translate3d("+e+"px, "+t+"px, 0)"}return this}function Le({node:t=e,drop:n=false,dropfn:r=false,upfn:i=false,downfn:s=false,leftfn:o=false,rightfn:f=false}={}){const u=t;u.addEventListener("touchstart",l,false);u.addEventListener("touchmove",d,false);let a=null;let c=null;function l(e){a=e.touches[0].clientX;c=e.touches[0].clientY}function d(e){if(a===null){return}if(c===null){return}const n=e.touches[0].clientX;const r=e.touches[0].clientY;const u=a-n;const l=c-r;if(Math.abs(u)>Math.abs(l)){if(u>0){if(Q(o)){o(t)}}else{if(Q(f)){f(t)}}}else{if(l>0){if(Q(i)){i(t)}}else{if(Q(s)){s(t)}}}a=null;c=null;e.preventDefault()}return this}function Oe(e){if(Q(e)){window.addEventListener("load",e,true)}return this}function Ee(e){if(Q(e)){window.addEventListener("scroll",e,true)}return this}function qe(e,t,n=false){if(n){window.removeEventListener(e,t,true)}else{window.addEventListener(e,t,true)}return this}function je(...e){return t=>e.reduce((e,t)=>t(e),t)}function Ie({end:t=false,fn:n=(()=>{})}={}){if(Q(n)){e.$stream.push(n)}if(t){const t=je(...e.$stream);return t()}else{return this}}function Ae(t){const n=Se(t.easing);let r=false;if(t.done){r=t.done}let i=true;if(t.offsetLeft){i=false}let s=false;let o=false;let f=false;let u;let a;let c=1;let l;let d;if(t.duration){d=t.duration}else{t.duration=1e3;d=1e3}if(t.move&&Q(t.move)){u=t.move}else{u=function(){}}if(t.stepfn&&Q(t.stepfn)){l=t.stepfn}if(t.move&&!Q(t.move)){s=t.move.dir||"right";o=t.move.amt||0;f=t.move.unit||"px";if(s==="left"){let t=Math.round(e.$rect("left"));if(!i){t=Math.round(e.offsetLeft)}e.$css(`left:  ${t}${f};`);u=function(n){e.$css(`left:  ${Math.round(t-n*o)}${f};`)}}if(s==="right"){u=function(t){e.$css(`left:  ${Math.round(t*o)}${f};`)}}if(s==="down"){const t=Math.round(e.$rect("top"));e.$css(`top:  ${t}${f};`);u=function(n){e.$css(`top:  ${Math.round(t+n*o)}${f}`)}}if(s==="up"){const t=Math.round(e.$rect("top"));e.$css(`top:  ${t}${f};`);u=function(n){e.$css(`top:  ${Math.round(t-n*o)}${f}`)}}}let p=false;if(t.prop){p=t.prop.opacity||"pos";if(p==="pos"){u=function(n){if(t.prop.to){if(n>=t.prop.to){n=t.prop.to}}e.$css(`opacity:  ${n};`)}}if(p==="neg"){u=function(n){let r=e.$cs("opacity");r-=n;if(t.prop.to){if(r<=t.prop.to){r=t.prop.to}}if(r<=0){r=0}e.$css(`opacity:  ${r};`)}}}let h=0;let $="";let m="width";let b="";let v=null;let y=null;if(t.prop&&t.prop.transition){t.prop.opacity=1;o=Number(Math.round(t.duration/1e3));if(o<1){o=1}const n=e.$cs(`${t.prop.transition}`)||"#FFF";const r=t.prop.from||n||"#FFFFFF";const i=t.prop.to||"#FFFFFF";function g(e){e.$css(`${t.prop.transition}: ${i}; transition: ${t.prop.transition} ${o}s;`)}e.$css(`${t.prop.transition}: ${r};  transition: ${t.prop.transition} ${o}s;`).$delay({time:t.duration||1e3,fn:g})}else{if(t.prop&&!t.prop.opacity){$=t.prop.unit||"px";y=t.prop.transition||"color";b=t.prop.sign||"";m=Object.entries(t.prop)[0][0]||"width";m=m.replace(/_/g,"-");v=Object.entries(t.prop)[0][1]||null;h=e.$cs(`${m}`,true);u=function(n){h=e.$cs(`${m}`,true);if(h==v){return}let r;if(!K(h)){r=h+n;$="";if(r>v||h>v){r=h-n}else{r=h+n}}else{if(r>v||h>v){r=Math.round(h-1)-Math.round(n*100)}else{r=Math.round(h+1)}}if(m!=="rotate"){e.$css(`${m}:  ${b}${r}${$};`)}else{r=h+n;r=Math.round(r);const i=t.prop.to||false;if(i){if(r>=i&&!b){r=i}}else{if(r>=360){r=1}}e.$css(`transform: rotate( ${b}${r}deg);`)}}}}const w=e.$cs("position");if(w==="static"&&n||!w&&n){e.$css(`position: relative;`)}const x=performance.now();requestAnimationFrame((function i(s){let o=(s-x)/t.duration;if(o>1)o=1;const f=n(o);if(t.step&&J(t.step)&&Q(l)){if(t.duration/t.step/t.step<t.step){a=a/2;if(t.debug){console.log(`steps of ${t.step} was decreasedto fit ${d} duration.`)}}a=t.step;const n=Math.round(f*a);if(n==c){c++;l(e,c)}}if(t.step&&Q(t.step)){t.step(e,f)}if(t.move&&Q(t.move)){u(e,f)}else{u(f)}if(o<1){requestAnimationFrame(i)}else{if(Q(r)){r(e)}e.isrun=false}}));return this}function Se(e){switch(e){case"bounceOut":return Ne;break;case"bounceInOut":return He;break;case"bounceIn":return Fe;break;case"linear":return function(e){return e};break;case"quadIn":return Be;break;case"quadOut":return Xe;break;case"quadInOut":return Ye;break;case"quinticIn":return nt;break;case"quinticOut":return rt;break;case"quinticInOut":return it;break;case"exponentialIn":return Re;break;case"exponentialOut":return ze;break;case"exponentialInOut":return We;break;case"elasticInOut":return Ge;break;case"elasticIn":return _e;break;case"elasticOut":return Ue;break;case"cubic":return De;break;case"circularIn":return Ze;break;case"circularOut":return et;break;case"circularInOut":return tt;break;case"backIn":return Je;break;case"backOut":return Ke;break;case"backInOut":return Qe;break;case"bow":return Pe.bind(null,5.5);break;default:return function(e){return e};break}}function Ve(e){return function(t){return 1-e(1-t)}}function Fe(e){for(let t=0,n=1,r;1;t+=n,n/=2){if(e>=(7-4*t)/11){return-Math.pow((11-6*t-11*e)/4,2)+Math.pow(n,2)}}}var Ne=Ve(Fe);function Ce(e){return function(t){if(t<.5){return e(2*t)/2}else{return(2-e(2*(1-t)))/2}}}var He=Ce(Fe);function Pe(e,t){return Math.pow(t,2)*((e+1)*t-e)}function De(e){return Math.pow(e,5)}function Be(e){return e*e}function Xe(e){return e*(2-e)}function Ye(e){if((e*=2)<1){return.5*e*e}return-.5*(--e*(e-2)-1)}function Re(e){return e===0?0:Math.pow(1024,e-1)}function ze(e){return e===1?1:1-Math.pow(2,-10*e)}function We(e){if(e===0){return 0}if(e===1){return 1}if((e*=2)<1){return.5*Math.pow(1024,e-1)}return.5*(-Math.pow(2,-10*(e-1))+2)}function Ue(e){if(e===0){return 0}if(e===1){return 1}return Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1}function _e(e){if(e===0){return 0}if(e===1){return 1}return-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)}function Ge(e){if(e===0){return 0}if(e===1){return 1}e*=2;if(e<1){return-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)}return.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1}function Je(e){const t=1.70158;return e===1?1:e*e*((t+1)*e-t)}function Ke(e){const t=1.70158;return e===0?0:--e*e*((t+1)*e+t)+1}function Qe(e){const t=1.70158*1.525;if((e*=2)<1){return.5*(e*e*((t+1)*e-t))}return.5*((e-=2)*e*((t+1)*e+t)+2)}function Ze(e){return 1-Math.sqrt(1-e*e)}function et(e){return Math.sqrt(1- --e*e)}function tt(e){if((e*=2)<1){return-.5*(Math.sqrt(1-e*e)-1)}return.5*(Math.sqrt(1-(e-=2)*e)+1)}function nt(e){return e*e*e*e*e}function rt(e){return--e*e*e*e*e+1}function it(e){if((e*=2)<1){return.5*e*e*e*e*e}return.5*((e-=2)*e*e*e*e+2)}function st(t=false,{vibe:r=true,fn:i=false,first:s=false}={}){let o;if(!t){return}else{if(n){o=$vibe.select(`${t}`,{all:true})}else{o=e.$select(`${t}`,{all:true})}}if(o.length){for(const e of o){if(r){e.$=Vibe().render(e)}}}if(Q(i)&&o.length){for(const e of o){i(e)}}if(s){return o[0]}else{return o}}function ot(t=false,{vibe:r=true,fn:i=false}={}){let s;if(!t){return}else{if(n){s=$vibe.select(`${t}`,{all:true});e.stk=s}else{s=e.$select(`${t}`,{all:true});e.$stk=s}}if(Q(i)&&s.length){for(const e of s){if(r){e.$=Vibe().render(e)}i(e)}}return this}const ft={fn:t,id:ie,uuid:ne,clone:P,ready:i,get:le,post:de,css:N,left:F,isTouch:pe,rpx:$,addClass:D,removeClass:B,children:_,parents:U,before:L,insertBefore:O,insertAfter:E,after:T,append:j,prepend:I,select:p,attr:R,removeAttr:X,appendTo:S,prependTo:A,createNode:C,filterString:re,dataset:z,data:W,detach:H,render:f,run:se,plugin:{},doc:document,rect:y,mountedTo:false,cs:b,ctx:v,on:a,observe:ue,observers:{},unobserve:ae,getobservers:ce,off:c,trigger:l,html:M,text:k,pager:ke,getState:fe,setState:oe,isFunction:Q,isObject:Z,isElement:ee,isArray:te,isString:G,isNumber:J,isInt:K,getAtPt:xe,isTouching:Me,drag:Te,swipe:Le,load:Oe,scroll:Ee,show:be,hide:ve,delay:ye,queue:ge,fadeIn:$e,fadeOut:me,templateReplacer:o,templater:s,q:[],runq:we,isrun:false,w:qe,pipe:Ie,stream:[],animate:Ae,each:ot,find:st,toggle:Y,stk:[]};for(const t in ft){const n="$"+t;e[n]=ft[t]}return ft}var $vibe=new Vibe(document);
